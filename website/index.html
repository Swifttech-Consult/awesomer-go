<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
		<meta http-equiv="X-UA-Compatible" content="ie=edge" />
		<title>Awesomer Go</title>
		<link rel="stylesheet" href="assets/css/bootstrap.min.css" />
		<link rel="stylesheet" href="assets/css/dataTables.bootstrap4.min.css" />
		<!-- This bundle includes jquery, bootstrap and datatables stuff, all in one -->
		<script src="assets/js/datatables-bundle.min.js"></script>
		<script src="assets/js/jquery.timeago.js"></script>
		<style rel="stylesheet">
			#datatable {
				width: 100% !important;
			}
		</style>
		<script>
			// Prepare variable for jsonp loading
			var DATA = null;
		</script>
		<script src="data.js"></script>
	</head>
	<body>
		<nav class="navbar navbar-expand-md navbar-light bg-light">
			<div class="container d-flex justify-content-between">
				<a class="navbar-brand" href="#">Awesomer GO</a>
			</div>
		</nav>

		<main role="main" class="container my-5">
			<table id="datatable" class="table table-striped table-bordered"></table>
		</main>
	</body>

	<script>
		$(document).ready(function() {
			if (!DATA) {
				alert(`Something went wrong during loading. We didn't get awesomer-go data.`);
				return;
			}

			// TODO
			// $.fn.dataTable.ext.errMode = 'none';

			function renderDate(date, type) {
				return type === 'display' && date
					? '<time class="text-nowrap" datetime="' +
							date +
							'" title="' +
							date +
							'">' +
							$.timeago(date) +
							'</time>'
					: date || '';
			}

			$('#datatable').DataTable({
				data: DATA,
				columns: [
					{
						data: 'index',
					},
					{
						data: 'title',
						title: 'Project',
						render: function(data, type, row, meta) {
							return type === 'display'
								? '<a href="' + row.url + '" target="_blank" rel="nofollow">' + data + '</a>'
								: data;
						},
					},
					{
						data: 'description',
						title: 'Description',
					},
					{
						data: 'created_at',
						title: 'Created',
						type: 'date',
						render: renderDate,
					},
					{
						data: 'last_commit_at',
						title: 'Updated',
						type: 'date',
						render: renderDate,
					},
				],
			});
		});
	</script>
</html>
